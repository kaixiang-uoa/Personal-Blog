@import 'prismjs/themes/prism-tomorrow.css';
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 222.2 47.4% 11.2%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    /* Increase contrast for muted-foreground */
    --muted-foreground: 215.4 16.3% 36%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 222.2 84% 4.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    /* Increase contrast for muted-foreground in dark mode */
    --muted-foreground: 215 20.2% 72%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    transition:
      background-color 0.3s ease,
      color 0.3s ease;
  }

  /* Accessible focus-visible outlines */
  :focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 3px;
  }

  a:focus-visible,
  button:focus-visible,
  [role='button']:focus-visible {
    box-shadow: 0 0 0 3px hsl(var(--ring) / 0.5);
    border-radius: 0.375rem;
  }

  /* fix select element style in dark mode */
  select {
    @apply bg-background text-foreground border-border;
  }

  /* fix select option color in dark mode */
  .dark select {
    color-scheme: dark;
  }

  /* fix option style in dark mode */
  .dark option {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}

/* theme switch animation */
* {
  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* special class when initializing */
.theme-init {
  animation: theme-fade-in 0.5s ease-in-out;
}

/* force theme change */
.force-theme-change {
  animation: theme-change 0.5s ease-in-out;
}

@keyframes theme-fade-in {
  0% {
    opacity: 0.8;
  }

  100% {
    opacity: 1;
  }
}

@keyframes theme-change {
  0% {
    opacity: 0.8;
  }

  50% {
    opacity: 0.9;
  }

  100% {
    opacity: 1;
  }
}

/* Tiptap/ProseMirror rich text style sync from admin-panel */
.ProseMirror {
  @apply outline-none min-h-[400px];
}

.ProseMirror p.is-editor-empty:first-child::before {
  @apply text-muted-foreground;
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

.ProseMirror h1 {
  @apply text-3xl font-bold mt-6 mb-4;
}

.ProseMirror h2 {
  @apply text-2xl font-bold mt-5 mb-3;
}

.ProseMirror h3 {
  @apply text-xl font-bold mt-4 mb-2;
}

.ProseMirror p {
  @apply my-2 leading-7;
}

.ProseMirror ul {
  @apply list-disc ml-6 my-3;
}

.ProseMirror ol {
  @apply list-decimal ml-6 my-3;
}

.ProseMirror blockquote {
  @apply border-l-4 border-gray-300 pl-4 italic my-4;
}

/* Dark mode styles for blockquote (cannot use dark: with @apply) */
.dark .ProseMirror blockquote {
  @apply border-gray-600;
}

.ProseMirror code {
  @apply bg-gray-100 rounded px-1 py-0.5;
}

.dark .ProseMirror code {
  @apply bg-gray-800;
}

.ProseMirror pre {
  @apply bg-gray-100 rounded p-4 my-4 overflow-x-auto;
}

.dark .ProseMirror pre {
  @apply bg-gray-800;
}

.ProseMirror pre code {
  @apply bg-transparent p-0;
}

.ProseMirror a {
  @apply text-primary underline;
}

.ProseMirror img {
  @apply max-w-full rounded-md mx-auto my-4;
}

/* only beautify inline code, not affect code block highlight */
.prose code:not(pre code) {
  background: #72757b;
  color: #f8f8f2;
  border-radius: 0.3em;
  padding: 0.2em 0.4em;
  font-size: 0.95em;
  font-family:
    'Fira Mono', 'Menlo', 'Monaco', 'Consolas', 'Liberation Mono', 'Courier New', monospace;
}

/* PrismJS tomorrow night eighties highlight style, set highest priority, prevent Tailwind from overriding */
code[class*='language-'],
pre[class*='language-'] {
  color: #ccc !important;
  background: none !important;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace !important;
  font-size: 1em;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;
  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;
  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

pre[class*='language-'] {
  padding: 1em !important;
  margin: 0.5em 0 !important;
  overflow: auto !important;
}

:not(pre) > code[class*='language-'],
pre[class*='language-'] {
  background: #2d2d2d !important;
}

:not(pre) > code[class*='language-'] {
  padding: 0.1em !important;
  border-radius: 0.3em !important;
  white-space: normal !important;
}

.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #999 !important;
}

.token.punctuation {
  color: #ccc !important;
}

.token.tag,
.token.attr-name,
.token.namespace,
.token.deleted {
  color: #e2777a !important;
}

.token.function-name {
  color: #6196cc !important;
}

.token.boolean,
.token.number,
.token.function {
  color: #f08d49 !important;
}

.token.property,
.token.class-name,
.token.constant,
.token.symbol {
  color: #f8c555 !important;
}

.token.selector,
.token.important,
.token.atrule,
.token.keyword,
.token.builtin {
  color: #cc99cd !important;
}

.token.string,
.token.char,
.token.attr-value,
.token.regex,
.token.variable {
  color: #7ec699 !important;
}

.token.operator,
.token.entity,
.token.url {
  color: #67cdcc !important;
}

.token.important,
.token.bold {
  font-weight: bold !important;
}

.token.italic {
  font-style: italic !important;
}

.token.entity {
  cursor: help !important;
}

.token.inserted {
  color: green !important;
}
